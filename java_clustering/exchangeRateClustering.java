package hw2.dataset1;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.SequenceFile;
import org.apache.hadoop.io.Text;
import org.apache.mahout.clustering.Cluster;
import org.apache.mahout.clustering.classify.WeightedPropertyVectorWritable;
import org.apache.mahout.clustering.kmeans.KMeansDriver;
import org.apache.mahout.clustering.kmeans.Kluster;
import org.apache.mahout.common.distance.EuclideanDistanceMeasure;
import org.apache.mahout.math.RandomAccessSparseVector;
import org.apache.mahout.math.Vector;
import org.apache.mahout.math.VectorWritable;

public class exchangeRateClustering {
	public static final double [] [] points = {{0.714286, 0.714286, 0.714286, 0.714286, 0.714286, 0.714286, 0.714286, 0.714286, 0.714286, 0.714286, 0.714286, 0.7128558, 0.657895, 0.657895, 0.630282, 0.6155016, 0.626601, 0.6447011, 0.635272, 0.6040074, 0.5467809, 0.6177082, 0.6734613, 0.7244099, 0.7665274, 0.8937741, 1.754523, 4.0160373, 4.5369667, 7.364735, 8.038285, 9.9094917, 17.298425, 22.0654, 21.996, 21.8952583, 21.884425, 21.88605, 21.886, 92.3381, 101.6973333, 111.23125, 120.5781583, 129.22235, 132.888025, 131.2743333, 128.6516667, 125.8081083, 118.5460167, 148.9017417, 150.298025, 154.7403, 157.4986712, 157.3116667}, 
	{0.7142851, 0.7142851, 0.7142851, 0.7142851, 0.7142851, 0.7142851, 0.7142851, 0.7242059, 0.833333, 0.833333, 0.833333, 0.830894, 0.8015579, 0.8192622, 0.8412034, 0.8638335, 0.9130114, 0.9029281, 0.8437451, 0.8168779, 0.8120957, 0.8952991, 1.0555091, 1.1747633, 1.41338, 1.7190967, 1.8610733, 2.2087425, 2.5613008, 2.7595242, 2.7288817, 2.8033125, 3.6032754, 4.4027783, 8.736405, 15.2837417, 15.3084667, 16.444175, 31.0726833, 44.0881417, 59.5438083, 72.1973333, 76.6866083, 97.432475, 108.8975083, 118.4197417, 136.0135417, 139.9572866, 140.5226921, 141.1669438, 150.4866559, 156.5154511, 249.1059501, 364.4072873},
	{2.4618095, 2.4618095, 2.4618095, 2.4618095, 2.4618095, 2.4618095, 2.4618095, 2.4618095, 2.4618095, 2.4618095, 2.4618095, 2.4618095, 2.245067, 1.989416, 1.9612, 1.8598, 1.9414, 1.8578238, 1.6836, 1.555, 1.4984, 1.7045333, 1.8925417, 1.975675, 2.3200417, 2.9366583, 3.4527917, 3.7221, 3.7221, 3.7651083, 4.7832083, 5.3233917, 5.5145917, 5.7619583, 8.6187427, 8.3514167, 8.314175, 8.2898167, 8.2789583, 8.27825, 8.2785042, 8.2770683, 8.2769575, 8.2770367, 8.2768008, 8.1943167, 7.9734383, 7.6075325, 6.948655, 6.8314161, 6.770269, 6.4614613, 6.3123328, 6.1957583},
	{2.1474259, 2.0622103, 2.0451674, 2.0451674, 2.0451674, 2.0451674, 2.0451674, 2.0451674, 2.0451674, 2.0161941, 1.8713, 1.7933, 1.6303, 1.3665, 1.3231, 1.2579, 1.2874, 1.1873, 1.027, 0.9371, 0.9294, 1.1555, 1.2407, 1.3055, 1.4551, 1.5052, 1.1103, 0.919, 0.8979, 0.9613, 0.8261, 0.8485, 0.7985, 0.8453, 0.8297, 0.7327, 0.7694, 0.8866, 0.8997, 0.9386, 1.0854, 1.1175, 1.0626, 0.886, 0.805365, 0.80412, 0.7971408, 0.7306375, 0.6826747, 0.7198434, 0.755045, 0.7193553, 0.7782936, 0.7531592},
	{3.3495833, 3.3498333, 3.3496667, 3.3496667, 0.00435, 0.0044, 0.0044, 0.0044, 0.0044, 0.0044, 0.0044, 0.0044, 0.0043, 0.0043, 0.0043, 0.0043, 0.0043, 0.0043, 0.0043, 0.0043, 0.0043, 0.0043, 0.0043, 0.0043, 0.0070167, 0.0075, 0.0080833, 0.0145, 0.0145, 0.0346917, 0.0468917, 0.056825, 0.0683833, 0.0908417, 0.1468583, 0.1768417, 0.41735, 0.4886333, 0.5475667, 0.605725, 0.6799667, 0.7236583, 1.16095, 1.6069583, 1.8913333, 2.08975, 2.147, 2.147, 2.147, 2.147, 2.5820603, 4.2893, 4.2893, 6.0479618},
	{7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.0203837, 7.1348111, 7.3431933, 8.367145, 8.2765608, 7.7293833, 7.4753092, 7.4201875, 9.0474983, 10.922325, 13.3115167, 14.413875, 16.4321167, 16.2257417, 16.4544917, 17.7471, 20.5724667, 22.9147667, 27.5078667, 32.2168333, 58.0013333, 56.050575, 51.4298333, 57.1148667, 58.7318417, 60.3667, 70.3262167, 76.1755417, 78.563195, 78.7491417, 75.9355694, 79.1738761, 75.5541095, 72.100835, 67.3176381, 69.1753198, 77.3520123, 79.2331517, 88.81077, 84.5296018, 86.1228789},
	{63.125, 124.7916667, 130, 130, 213.8466667, 266.4008333, 271.3375, 270.5166667, 276.645, 288.1608333, 310.5558333, 347.1475, 392.8941667, 398.3216667, 404.4725, 484, 484, 484, 484, 484, 607.4325, 681.0283333, 731.0841667, 775.7483333, 805.9758333, 870.02, 881.4541667, 822.5675, 731.4683333, 671.4558333, 707.7641667, 733.3533333, 780.6508333, 802.6708333, 803.4458333, 771.2733333, 804.4533333, 951.2891667, 1401.436667, 1188.816667, 1130.9575, 1290.994583, 1251.088333, 1191.614167, 1145.319167, 1024.116667, 954.7905158, 929.2572617, 1102.046667, 1276.93, 1156.060988, 1108.292125, 1126.470826, 1094.852917},
	{0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.3560977, 0.3289488, 0.2965723, 0.2931514, 0.2900323, 0.2923874, 0.286566, 0.2750527, 0.2763661, 0.2702974, 0.2787853, 0.287911, 0.2914767, 0.2960619, 0.3007532, 0.2905947, 0.2786632, 0.2790292, 0.2937794, 0.288455, 0.2842686, 0.2932227, 0.3018386, 0.2968703, 0.2984477, 0.2994086, 0.3033488, 0.3047556, 0.3044147, 0.3067516, 0.3066817, 0.3039143, 0.2980115, 0.2947, 0.292, 0.2901762, 0.284214, 0.2688284, 0.2877854, 0.2866066, 0.2759789, 0.2799356, 0.2835833},
	{4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7648426, 5.4594854, 4.9310476, 4.8625169, 6.3793993, 6.7067494, 7.0675998, 6.7982604, 6.5857614, 6.5381423, 7.2203373, 7.7090638, 7.9603969, 8.303267, 8.47485, 7.330375, 6.65345, 6.3945417, 6.7049, 6.3385583, 6.2837, 6.1045333, 6.1569667, 5.9749125, 5.6670417, 5.9175667, 6.2418333, 6.3431583, 6.2857917, 6.516725, 6.7489083, 6.6420833, 6.138925, 5.8058333, 5.8181667, 5.8429417, 5.6168833, 5.44145, 5.5763667, 5.6348833, 5.4441083, 640.6534167, 933.5704541},
	{4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 8.6813826, 9.99425, 9.9, 9.9, 9.9, 9.9, 9.9, 9.9, 9.9, 9.9, 11.8474667, 13.116975, 14.0463333, 15.9283917, 16.6475083, 17.3988, 18.0032917, 20.5414917, 21.707375, 23.8007667, 25.0827917, 28.1071833, 30.5665917, 31.6426833, 36.0786833, 41.111525, 45.0466667, 49.5006916, 53.6481865, 61.9271617, 59.7237817, 57.7519967, 58.2578633, 59.514475, 60.271335, 60.7385158, 70.4080333, 81.7128917, 85.1938163, 86.3433833, 93.3951972, 101.6288992},
	{5.17321, 5.17321, 5.17321, 5.17321, 5.17321, 5.17321, 5.17321, 5.17321, 5.17321, 5.17321, 5.17321, 5.1259052, 4.7624167, 4.36725, 4.439425, 4.1521917, 4.3558917, 4.4816417, 4.518475, 4.2870833, 4.229575, 5.0634417, 6.2826083, 7.6671083, 8.2718, 8.603925, 7.1235833, 6.3404417, 6.12715, 6.4468758, 5.91879, 6.0474667, 5.8238333, 7.7834267, 7.71597, 7.1332683, 6.7059558, 7.6348942, 7.9498682, 8.2624283, 9.1622442, 10.3291358, 9.7371233, 8.0863042, 7.3488867, 7.4730883, 7.3782492, 6.75877, 6.5910992, 7.6538192, 7.2075242, 6.4935433, 6.7750158, 6.5139717},
	{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
	{0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.3571433, 0.3285709, 0.3220917, 0.3197917, 0.3319833, 0.3292667, 0.305625, 0.3003333, 0.297925, 0.3304333, 0.3524917, 0.3630792, 0.384465, 0.394625, 0.3499658, 0.3384587, 0.3742925, 0.5745758, 0.6637117, 0.6808658, 0.6798183, 0.6928508, 0.6987642, 0.7003775, 0.709, 0.709, 0.709, 0.709, 0.709, 0.7089832, 0.7089998, 0.709, 0.709, 0.709, 0.709, 0.7089998, 0.7096666, 0.71, 0.71, 0.71, 0.71, 0.71},
	{6.6349998, 6.6999998, 6.9012079, 9, 9, 10.5, 13.5, 14.5066667, 16.2916667, 17.3216667, 18.4441667, 19.9333333, 21.8666667, 23.5716667, 26.0616667, 30.9275, 34.695, 36.7741667, 39.095, 42.5483333, 47.2783333, 54.4891667, 64.0858333, 78.8575, 100.8175, 142.3116667, 194.2608333, 242.6066667, 299.1733333, 382.5666667, 502.26, 633.05, 680.1, 786.6696735, 826.5602429, 912.7834156, 1036.550776, 1141.084403, 1427.041653, 1758.577143, 2087.677895, 2299.825328, 2504.99849, 2876.339448, 2628.762362, 2321.564865, 2358.478222, 2077.2537, 1967.1123, 2158.2559, 1898.5696, 1848.1395, 1796.8959, 1868.7853},
	{360.0000004, 360.0000004, 360.0000004, 360.0000004, 360.0000004, 360.0000004, 360.0000004, 360.0000004, 360.0000004, 360.0000004, 360.0000004, 350.6776935, 303.1725, 271.7016667, 292.0825, 296.7875, 296.5525, 268.51, 210.4416667, 219.14, 226.7408333, 220.5358333, 249.0766667, 237.5116667, 237.5225, 238.5358333, 168.5198333, 144.6375, 128.1516667, 137.9644167, 144.7925, 134.7066667, 126.6513333, 111.1977858, 102.2078058, 94.0595792, 108.7790567, 120.9908625, 130.9053007, 113.906805, 107.7654983, 121.5289475, 125.3880192, 115.9334642, 108.1925692, 110.2182117, 116.2993117, 117.7535292, 103.359494, 93.5700891, 87.779875, 79.8070198, 79.7904554, 97.5956583},
	{28.7000866, 28.7000866, 28.7000866, 28.7000866, 28.7000866, 28.75, 28.75, 28.75, 28.75, 28.75, 28.75, 28.3121, 27.0534, 24.5152, 25.4082, 25.5432, 30.2291, 34.0465, 35.5007, 37.433, 40.1749, 48.6947, 58.2933, 71.6858, 84.8779, 91.6317, 80.1449, 72.4658, 72.0675, 77.9781, 70.0313, 71.408, 68.018, 80.427, 81.891, 76.853, 82.591499, 93.117, 98.158, 103.502, 119.6871499, 123.2278277, 117.1675723, 97.7029876, 88.8075985, 88.6703124, 87.9007197, 80.5673971, 75.2785404, 79.3771273, 83.2588069, 79.3233038, 85.77, 83.02},
	{245.1930236, 245.2580233, 245.0117745, 245.0142744, 245.0251077, 245.0588576, 245.6763547, 245.9988532, 247.5625959, 259.9583715, 276.4007948, 275.3543126, 252.0254918, 222.8872943, 240.7026279, 214.3110843, 238.9484694, 245.6776047, 225.653948, 212.7198417, 211.277765, 271.7291499, 328.6034681, 381.0628069, 436.952963, 449.2591557, 346.302969, 300.5340157, 297.8456949, 319.0055962, 272.2624808, 282.1045183, 264.6895578, 283.16018, 416.398821, 374.3570933, 383.6599915, 437.7470875, 442.4588359, 461.7745836, 533.9824772, 549.7791597, 522.7414183, 435.9004569, 396.2138083, 395.6013082, 392.1677815, 359.4502696, 335.8541123, 354.139898, 371.4579549, 353.8997654, 382.8955465, 370.53},
	{0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.3621033, 0.416667, 0.416667, 0.416667, 0.4154475, 0.383773, 0.3506762, 0.3454, 0.3454, 0.3454, 0.3454, 0.3454, 0.3454, 0.3454, 0.3454, 0.3454, 0.3454, 0.3453975, 0.345395, 0.3819819, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845, 0.3845},
	{123.1666667, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 126, 201, 306.6666667, 339.1666667, 550, 550, 1056.216667, 1229.808333, 1325.183333, 1500.258333, 1744.345833, 1904.760833, 1963.019167, 2056.811667, 2177.8625, 2726.49, 3119.073333, 3486.353333, 4105.925, 5716.258333, 6424.339167, 5974.5775, 6177.958333, 5635.4625, 5032.716667, 4363.241667, 4965.391667, 4735.461667, 4191.41625, 4424.9175, 4320.674167},
	{5.6362691, 5.9742112, 6.6500945, 6.6500945, 6.6500945, 6.625, 6.625, 6.625, 6.625, 6.625, 6.625, 6.6258001, 6.6350002, 6.6468, 7.9299998, 8.5699997, 8.5699997, 8.5699997, 8.5699997, 8.5699997, 8.5699997, 21.7632999, 37.4067001, 41.0942001, 44.5326996, 50.5, 55.8, 62.77, 75.79, 81.11, 91.54, 122.43, 134.5063, 142.1717, 157.0667, 179.63, 207.71, 232.6, 257.19, 285.68, 308.19, 328.87, 359.82, 398.6633333, 437.9108333, 477.7875, 511.3018, 516.6174, 526.3542, 573.288, 525.8292, 505.6642, 502.9015, 499.7668},
	{0.34824, 0.34824, 0.40449, 0.43478, 0.43478, 0.4578, 0.4633, 0.4522, 0.428, 0.413, 0.3981, 0.3921, 0.3868, 0.3958, 0.4813, 0.4562, 0.5035, 0.5701, 0.6596, 0.7, 0.72, 0.74, 0.812, 0.859, 0.9302, 0.9551, 1.069, 1.273, 1.761, 1.9368, 2.2290001, 3.0090001, 3.3233399, 3.332, 3.372, 3.391, 3.392, 3.3900001, 3.388, 3.391, 3.4065001, 3.674, 4.3130002, 5.03475, 6.1551, 6.0043, 5.7469, 5.70825, 5.5, 5.51475, 5.5124129, 5.8097277, 5.9945, 6.4466},
	{5.06049, 5.06049, 5.06049, 5.06049, 5.06049, 5.06049, 5.06049, 5.06049, 5.06049, 5.06049, 5.06049, 5.0499589, 4.5924803, 4.1069208, 4.3697667, 4.0524875, 4.4193125, 4.5033458, 4.1666708, 3.8991342, 3.9366458, 5.1722958, 6.0230225, 7.1113233, 8.8105358, 10.0624942, 9.1044417, 8.359225, 8.20915, 8.48817, 8.2423417, 8.70655, 8.537875, 9.2987092, 9.202715, 8.5402358, 8.7158758, 9.5271067, 9.6044158, 9.8044192, 10.6256362, 11.302975, 11.0205833, 9.5743833, 8.8680167, 8.8650083, 8.7955833, 8.1923333, 7.750325, 8.0571, 8.4171571, 8.089875, 8.6284446, 8.4055039},
	{0.9697833, 1.0130667, 1.0687667, 1.0785083, 1.0786083, 1.0779833, 1.0773167, 1.0787083, 1.077475, 1.076775, 1.044915, 1.0097917, 0.9899333, 1.0000833, 0.9780333, 1.0171583, 0.986025, 1.06345, 1.140675, 1.171425, 1.1692167, 1.1989083, 1.2337333, 1.2324167, 1.2950667, 1.3654833, 1.3895, 1.3259917, 1.2307083, 1.1839917, 1.166775, 1.1457167, 1.208725, 1.2900742, 1.3656383, 1.3724408, 1.3634683, 1.3846167, 1.4834631, 1.4857317, 1.48511, 1.5487608, 1.5693183, 1.4010517, 1.3010192, 1.2117633, 1.1343633, 1.0740992, 1.06704, 1.1431006, 1.0301628, 0.9895307, 0.9991883, 1.0297966},
	{0.5382014, 0.5382014, 0.5382014, 0.5382014, 0.5382014, 0.5382014, 0.5382014, 0.5802472, 0.7063842, 0.7063842, 0.7064, 0.7038, 0.6974, 0.6427, 0.6347, 0.6187, 0.6499, 0.6777, 0.6925, 0.6551, 0.6274, 0.7258, 0.8107, 0.9368, 1.0108, 1.0424, 0.8526, 0.7393, 0.7035, 0.7217, 0.6431, 0.6801, 0.7534, 0.9607, 0.8785, 0.7344, 0.7726, 0.8731, 0.8988, 0.9386, 1.0854, 1.1175, 1.0626, 0.886, 0.805365, 0.80412, 0.7971408, 0.7306375, 0.6826747, 0.7198434, 0.755045, 0.7193553, 0.7782936, 0.7531592},
	{0.7526499, 0.7526499, 0.7526499, 0.7526499, 0.7526499, 0.7526499, 0.7526499, 0.7526499, 0.7526499, 0.7918504, 0.8467, 0.8447, 0.769, 0.6788, 0.7332, 0.6537, 0.7322, 0.7478, 0.688, 0.6486, 0.6442, 0.8285, 1.0019, 1.1619, 1.3323, 1.3698, 1.0559, 0.9163, 0.9081, 0.9726, 0.8301, 0.8601, 0.807, 0.8634, 0.8464, 0.7609, 0.7799, 0.8898, 0.8994, 0.9386, 1.0854, 1.1175, 1.0626, 0.886, 0.805365, 0.80412, 0.7971408, 0.7306375, 0.6826747, 0.7198434, 0.755045, 0.7193553, 0.7782936, 0.7531592},
	{0.0880411, 0.0880411, 0.0880411, 0.0880411, 0.0880411, 0.0880411, 0.0880411, 0.0880411, 0.0880411, 0.0880411, 0.088, 0.088, 0.088, 0.0869, 0.088, 0.0941, 0.1072, 0.1081, 0.1078, 0.1087, 0.1251, 0.1626, 0.196, 0.2584, 0.3308, 0.4053, 0.4108, 0.3974, 0.4163, 0.4766, 0.4652, 0.5349, 0.5594, 0.6728, 0.712, 0.6799, 0.7064, 0.8013, 0.8673, 0.9386, 1.0854, 1.1175, 1.0626, 0.886, 0.805365, 0.80412, 0.7971408, 0.7306375, 0.6826747, 0.7198434, 0.755045, 0.7193553, 0.7782936, 0.7531592},
	{0.361905, 0.400833, 0.43, 0.43, 0.43, 0.43, 0.43, 0.4416667, 0.6216667, 0.88, 0.88, 0.88, 0.8826, 0.9013, 0.9995, 1.537, 1.8217, 1.9887, 2.7111, 3.526, 4.7976, 7.2242, 12.3515, 24.8428, 31.6937, 41.5077, 41.1042, 38.6772, 43.014, 57.0418, 58.2838, 58.9963, 57.5459, 67.6032, 69.9444, 64.6917, 66.5, 70.9043, 70.9583, 72.3353, 78.616, 97.4246, 91.6617, 76.709, 70.1917, 62.9816667, 70.18, 64.055, 87.9479167, 123.6383814, 122.2418112, 115.9540398, 125.082787, 122.1791213},
	{0.322262, 0.3227856, 0.3227856, 0.3227856, 0.3227856, 0.3227856, 0.3227856, 0.3227856, 0.3227856, 0.3227856, 0.3228, 0.3204, 0.3012, 0.3011, 0.3359, 0.3372, 0.4299, 0.4557, 0.4383, 0.4291, 0.4423, 0.5871, 0.6985, 0.7844, 0.9074, 0.9861, 0.7699, 0.6694, 0.6722, 0.7086, 0.6188, 0.6407, 0.6365, 0.8127, 0.8328, 0.8413, 0.7969, 0.8796, 0.8967, 0.9386, 1.0854, 1.1175, 1.0626, 0.886, 0.805365, 0.80412, 0.7971408, 0.7306375, 0.6826747, 0.7198434, 0.755045, 0.7193553, 0.7782936, 0.7531592},
	{0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.3563257, 0.328947, 0.300026, 0.296051, 0.296051, 0.296051, 0.296051, 0.296051, 0.296051, 0.2960507, 0.2960517, 0.296053, 0.296053, 0.296053, 0.296053, 0.3153958, 0.2970286, 0.2857662, 0.2996017, 0.2831772, 0.2807283, 0.2815534, 0.3043702, 0.3483682, 0.4181449, 0.4367998, 0.4608661, 0.4675744, 0.4638108, 0.5121896, 0.6050643, 1.2706792, 1.2929441, 1.3049661, 1.3083848, 1.3135716, 1.2626449, 1.2235624, 1.2535345, 1.2667894, 1.2241525, 1.2616596, 1.271598},
	{3.06122, 3.06122, 3.06122, 3.06122, 3.06122, 3.06122, 3.06122, 3.06122, 3.06122, 3.06122, 3.06122, 3.0522604, 2.8195559, 2.4433297, 2.4070667, 2.3937833, 2.541575, 2.4612833, 2.3160417, 2.1884417, 2.1768833, 2.304125, 2.3353917, 2.32125, 2.3436417, 2.4830417, 2.5814417, 2.5196383, 2.6187833, 2.7088417, 2.704875, 2.7500667, 2.5473833, 2.574095, 2.6242567, 2.5044042, 2.5159425, 2.8131917, 3.924375, 3.8, 3.8, 3.8, 3.8, 3.8, 3.8, 3.7870917, 3.668177, 3.4375694, 3.3358333, 3.5245029, 3.2210869, 3.060003, 3.0888009, 3.1509086},
	{4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.7619, 4.8280375, 5.55555, 5.55555, 5.55555, 5.4857589, 5.3385262, 5.4422657, 5.7030751, 6.0267973, 6.681525, 6.6073083, 6.163275, 6.3081083, 7.6842917, 8.9365417, 10.87255, 11.7062, 13.8003333, 15.4424833, 13.4663583, 12.8782167, 13.437725, 15.2497667, 14.8634667, 15.6523083, 15.5632083, 17.648025, 17.9603667, 17.3863167, 17.9480667, 21.0572583, 23.99265, 25.1858083, 26.2495583, 29.1292583, 29.962, 27.901475, 27.4985167, 29.4962333, 31.7080667, 31.3136563, 28.4528375, 31.9598, 30.7844, 28.70595, 30.0499717, 30.7013583},
	{0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0125, 0.0154258, 0.0225729, 0.0227673, 0.0228054, 0.022951, 0.0245146, 0.0564017, 0.1200936, 0.1678276, 0.2568716, 0.6117726, 1.3781825, 2.273105, 2.4614725, 2.8125992, 3.01843, 3.0948983, 3.1156167, 3.3751167, 6.419425, 7.5994484, 7.91846, 9.1360418, 9.5603975, 9.4555583, 9.3423417, 9.6559583, 10.7890192, 11.2859667, 10.8978917, 10.8992417, 10.9281917, 11.1297167, 13.513475, 12.6360083, 12.423325, 13.1694583, 12.7719917},
	{7.5, 7.619, 7.619, 7.619, 7.619, 7.619, 7.61725, 8.0341667, 10.125, 10.125, 10.125, 10.125004, 10.125, 10.471509, 10.56, 11.0028333, 12.5, 12.5, 12.1105, 12, 12, 12.3363333, 13.2438333, 14.54525, 16.4594167, 18.2464167, 21.2298333, 21.8191667, 23.28925, 27.1888333, 29.3691667, 37.255, 42.7175, 48.607165, 49.3975183, 51.8903333, 56.6919525, 58.0095492, 65.9757875, 68.2393708, 71.0937958, 74.94925, 77.8766192, 76.1414475, 73.6735967, 71.3675, 72.7556058, 66.4150275, 69.761695, 77.545214, 73.1555468, 74.01968, 85.1971554, 93.5818374},
	{7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.14286, 7.0559055, 6.5882492, 5.7658333, 5.5397083, 5.2269417, 5.4565167, 5.3235, 5.24225, 5.0640667, 4.939225, 5.7395083, 6.4540333, 7.2963667, 8.1614583, 8.5972333, 7.3947417, 6.73745, 6.5169833, 6.9045, 6.2597417, 6.4829425, 6.2145008, 7.0941292, 7.0575842, 6.3351567, 6.4498083, 7.0734008, 7.5450975, 7.7991717, 8.8018417, 8.9916542, 7.9837788, 7.0802167, 6.7408333, 6.4425, 6.4133333, 5.8616667, 5.64, 6.2883333, 6.0441667, 5.6046073, 5.8175, 5.875},
	{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
	{0.0004, 0.0004, 0.0004, 0.0004, 0.0004, 0.0004, 0.0004, 0.0004, 0.0004, 0.0004, 0.0004, 0.0003893, 0.000368, 0.000335, 0.000332, 0.000332, 0.000332, 0.000332, 0.000581, 0.00332, 0.0044217, 0.0051152, 0.0084824, 0.009155, 0.011324, 0.0147142, 0.0175287, 0.0265082, 0.0430546, 0.1439184, 0.95, 1.0576058, 1.3626433, 1.8114967, 2.2722767, 2.4249833, 2.6961, 3.2792917, 3.4754, 3.9671083, 4.346075, 4.0939, 4.0800333, 3.889075, 3.6576417, 3.2354833, 3.1031583, 2.76795, 2.4092417, 3.1201417, 3.0153, 2.9628478, 3.2565417, 3.1606167},
	{0.0006, 0.0006, 0.0006, 0.0006, 0.0006, 0.0006, 0.0006, 0.0006, 0.0006, 0.0006, 0.0006, 0.0006, 0.000553, 0.0018794, 0.002, 0.002, 0.002, 0.002, 0.001836, 0.0018, 0.0018, 0.0015, 0.0015, 0.0017178, 0.002128, 0.0017141, 0.0016153, 0.0014557, 0.0014277, 0.0014922, 0.0022432, 0.0076387, 0.0307953, 0.0760051, 0.1655086, 0.2033276, 0.3084218, 0.7167943, 0.8875576, 1.5332838, 2.1708721, 2.9060792, 3.305543, 3.3200071, 3.2636568, 2.9136532, 2.8089833, 2.43825, 2.5188583, 3.049325, 3.1779, 3.0486083, 3.4682, 3.3279167},
	{0.3606073, 0.3606073, 0.3606073, 0.3606073, 0.3606073, 0.3606073, 0.3606073, 0.3706242, 0.4207085, 0.4207085, 0.4207, 0.4175, 0.3863, 0.3502, 0.3467, 0.345, 0.4021, 0.4565, 0.4608, 0.4034, 0.4309, 0.5549, 0.6603, 0.862, 0.9662, 1.022, 0.8417, 0.7421, 0.7001, 0.7115, 0.6126, 0.6245, 0.6153, 0.7649, 0.8051, 0.7494, 0.7613, 0.88, 0.8979, 0.9386, 1.0854, 1.1175, 1.0626, 0.886, 0.805365, 0.80412, 0.7971408, 0.7306375, 0.6826747, 0.7198434, 0.755045, 0.7193553, 0.7782936, 0.7531592},
	{0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003482, 0.0003775, 0.0004292, 0.0005, 0.0005589, 0.0009523, 0.0013, 0.0013, 0.002304, 0.0025, 0.003, 0.0045, 0.0045, 0.0045, 0.0069556, 0.0974317, 0.1593139, 0.2896089, 0.5808738, 1.2507917, 1.5757425, 2.0080192, 2.5255042, 2.571225, 2.587021, 2.6330583, 2.6098343, 2.57905, 2.4360583, 2.1715333, 2.0161, 2.0901628, 2.3015333, 2.3060009, 2.6666196, 3.5729583, 4.7567605},
	{0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.357143, 0.3621033, 0.416667, 0.416667, 0.4167, 0.4109, 0.4004, 0.4082, 0.4278, 0.452, 0.5565, 0.5733, 0.5215, 0.4722, 0.4303, 0.4976, 0.5724, 0.6597, 0.7518, 0.7792, 0.6822, 0.6119, 0.5622, 0.6112, 0.5632, 0.567, 0.5698, 0.6668, 0.6534, 0.6337, 0.641, 0.6108, 0.6038, 0.6181, 0.6609, 0.6947, 0.6672, 0.6125, 0.54618, 0.5499983, 0.5434867, 0.4997717, 0.5439662, 0.6419193, 0.6471793, 0.6241408, 0.633047, 0.6396606}};
	
	public static void writePointsToFile(List<Vector> points, String fileName, FileSystem fs, Configuration conf) throws IOException {
		Path path = new Path(fileName);
		SequenceFile.Writer writer = new SequenceFile.Writer(fs, conf, path, LongWritable.class, VectorWritable.class);
		long recNum = 0;
		VectorWritable vec = new VectorWritable ();
		for (Vector point : points) {
			vec.set(point);
			writer.append(new LongWritable(recNum++), vec);
		}
		writer.close();
		
	}
	
	public static List<Vector> getPoints(double[][] raw) {
		List<Vector> points = new ArrayList<Vector>();
		for (int i = 0; i < raw.length; i++) {
			double[] fr = raw[i];
			Vector vec = new RandomAccessSparseVector(fr.length);
			vec.assign(fr);
			points.add(vec);
		}
		return points;
	}

	public static void main (String args[]) throws Exception {
		int k = 10;
		List<Vector> vectors = getPoints(points);
		File testData = new File("clustering/exchangeRateData");
		if (!testData.exists()) {
			testData.mkdir();
		}
		testData = new File("clustering/exchangeRateData/points");
		if (!testData.exists()) {
			testData.mkdir();
		}
		
		Configuration conf = new Configuration();
		FileSystem fs = FileSystem.get(conf);
		writePointsToFile(vectors, "clustering/exchangeRateData/points/file1", fs, conf);
		Path path = new Path("clustering/exchangeRateData/clusters/part-00000");
		SequenceFile.Writer writer = new SequenceFile.Writer(fs,  conf,  path,  Text.class,  Kluster.class);
	
		for(int i = 0; i < k; i++) {
			Vector vec = vectors.get(i);
			Kluster cluster = new Kluster(vec, i, new EuclideanDistanceMeasure());
			writer.append(new Text(cluster.getIdentifier()), cluster);
		}
		writer.close();
		
		KMeansDriver.run(conf, new Path("clustering/exchangeRateData/points"), new Path("clustering/exchangeRateData/clusters"), new Path("clustering/output"), 0.001, 10, true, 0, true);
		SequenceFile.Reader reader = new SequenceFile.Reader(fs, new Path("clustering/output/" + Cluster.CLUSTERED_POINTS_DIR + "/part-m-0"), conf);
		IntWritable key = new IntWritable();
		WeightedPropertyVectorWritable value = new WeightedPropertyVectorWritable ();
		while (reader.next(key, value)) {
			System.out.println(value.toString() + " belongs to cluster " + key.toString());
		}
		reader.close();
	}
}

